<!--
    A hodgepodge of random scripts to aid in rendering Minecraft skins
	Latest code should be available at https://github.com/earthiverse

	The MIT License

	Copyright (c) 2014-2018 Kent Rasmussen

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in
	all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	THE SOFTWARE.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>3D Minecraft Skin Viewer</title>
<script src="js/2dskin.js" type="text/javascript"></script>
<script src="js/three.min.js" type="text/javascript"></script>
</head>
<style>
@import url(http://fonts.googleapis.com/css?family=Lato);

body {
	background-image: url('images/bg_stone.png');
	font-family: 'Lato', sans-serif;
	font-size: 11px;
}

* {
	border: 0;
	margin: 0;
	padding: 0;
}

#sidebar {
	background-color: rgba(255, 255, 255, 0.6);
	border-right:10px solid #999;
	height:100%;
	position: absolute;
	width: 240px;
}
#sidebar strong {
	display: block;
	clear: both;
	margin:5px 5px 0 5px;
}

#sidebar input[type="text"] {
	border:1px solid #999;
	display: inline-block;
	clear: both;
	margin:2px 5px 0 5px;
	padding:2px;
	width:224px;
}

#sidebar input[type="checkbox"] {
	border:1px solid #999;
	clear: left;
	margin:2px 5px 0 5px;
	vertical-align:bottom;
}

#sidebar label {
	display: block;
	padding:0 5px 2px 5px;
	clear:both;
}

#model {
	display: inline-block;
	position: absolute;
	left: 250px;
}

#canvas {
	bottom:5px;
	left: 86px;
	position:absolute;
	z-index:1;
}

#info {
	color: #000000;
	bottom:5px;
	font-size:9px;
	right:5px;
	position:absolute;
	text-align:right;
	z-index:1;
}

#info a {
	color: #0062ff;
	font-weight:bold;
}
</style>
<body>
<canvas id="canvas" width="64" height="64"></canvas>
<div id="sidebar">
	<strong>Enter Username</strong>
	<input id="username" type="text" value="Termynat0r">
    <div ><br /></div>
    
	<strong>Or load skin file</strong>
	<input type="file" accept="image/*" id="file_input">
	<div ><br /></div>

	<strong>Toggle Visibility - Body Parts</strong>
	<label><input id="headToggle" type="checkbox" checked>Head</label>
	<label><input id="bodyToggle" type="checkbox" checked>Body</label>
	<label><input id="leftArmToggle" type="checkbox" checked>Left Arm</label>
	<label><input id="rightArmToggle" type="checkbox" checked>Right Arm</label>
	<label><input id="leftLegToggle" type="checkbox" checked>Left Leg</label>
	<label><input id="rightLegToggle" type="checkbox" checked>Right Leg</label>
    <div ><br /></div>
	
	<strong>Toggle Visibility - Secondary Layer</strong>
	<label><input id="head2Toggle" type="checkbox" checked>Head</label>
	<label><input id="body2Toggle" type="checkbox" checked>Body</label>
	<label><input id="leftArm2Toggle" type="checkbox" checked>Left Arm</label>
	<label><input id="rightArm2Toggle" type="checkbox" checked>Right Arm</label>
	<label><input id="leftLeg2Toggle" type="checkbox" checked>Left Leg</label>
	<label><input id="rightLeg2Toggle" type="checkbox" checked>Right Leg</label>
</div>
<div id="model">
</div>
<div id="info">
	3D Skin Viewer v2 by <a href="https://github.com/earthiverse/3D-Minecraft-Skin-Viewer">earthiverse</a><br />
    3D Skin Viewer v3 by <a href="http://twitter.com/Termynator">Termynat0r</a><br />
	Skins downloaded from <a href="https://crafatar.com/">Crafatar</a>
</div>
<script type="text/javascript">
	var scene, camera, renderer;
	
	var radius = 32;
	var alpha = 0;
	var rotationX = 0;
    var rotationY = 0;
	
	var sidebarWidth = 250;
    var rendererIsSetup = false;

    scene = new THREE.Scene();
    
    //Setup Camera
	camera = new THREE.PerspectiveCamera(75, (window.innerWidth - sidebarWidth) / window.innerHeight, 1, 10000);
    var camera_translate = -12;
    var camera_target = new THREE.Object3D()
    camera_target.position.set(0, camera_translate, 0);
	
	canvas = document.getElementById('canvas');
        canvas.width = 64;
        canvas.height = 64;
        var context = canvas.getContext("2d");
	
	var skinTexture = new THREE.Texture(canvas);
	skinTexture.magFilter = THREE.NearestFilter;
	skinTexture.minFilter = THREE.NearestMipMapNearestFilter;
	
	// Get the texture for the skin
	material = new THREE.MeshBasicMaterial({map: skinTexture, side: THREE.FrontSide});
	material2 = new THREE.MeshBasicMaterial({map: skinTexture, transparent: true, opacity: 1, alphaTest: 0.5, side: THREE.DoubleSide});
	
	var img = new Image();
	img.crossOrigin = '';
    var hasAnimate = false;
	img.onload = function() {
		console.log("Loaded Image");
		
		// Erase what was on the canvas before
		context.clearRect(0, 0, 64, 64);
		
		// Draw the image to the canvas
		context.drawImage(img, 0, 0);
		
		// Convert the image if need be
		if(img.height == 32) Convert6432To6464(context);
        
        //Check if the skin is in alex or steve format
        var smallSkin = IsSmallSkinFormat(context);
        
		FixNonVisible(context, smallSkin);
        //Minecraft doesn't anymore remove overlays if they aren't transparent
        //Instead you can remove your characters overlays in the minecraft settings
		
		skinTexture.needsUpdate = true;
		material.needsUpdate = true;
		material2.needsUpdate = true;
        
        //Needs to be re-rendered on alex/steve format change
        RenderSkin(smallSkin); 
        
        if (!hasAnimate) {
            hasAnimate = true;
            Animate();
        }
	}
	img.onerror = function() {
		console.log("Failed loading " + img.src);
	}
    
    // I use crafatar because it allows CORS requests.
	// Minotar stopped working.
	img.src = 'http://crafatar.com/skins/Termynat0r';

    //Moving the camera via mouse
	var isDown = false;
	var oldMousePos;
    document.getElementById('model').addEventListener("mousedown", handleMouseDown, false);
	function handleMouseDown(e){
		oldMousePos = getMousePos(document.getElementById('model'), e);
  		isDown=true;
	}
    document.getElementById('model').addEventListener("mousemove", handleMouseMove, false);
	function handleMouseMove(e){
  		if(!isDown){ return; }
		var pos = getMousePos(document.getElementById('model'), e);
  		var dx=pos.x-oldMousePos.x;
  		var dy=pos.y-oldMousePos.y;
  		rotationX += -dx/100.0;
        rotationY += -dy/100.0;
        if (rotationY > Math.PI/2) rotationY = Math.PI/2;
        else if (rotationY < -Math.PI/2) rotationY = -Math.PI/2;
  		oldMousePos = pos;
	}
    document.getElementById('model').addEventListener("mouseup", handleMouseUp, false);
	function handleMouseUp(e){
      isDown=false;
    }
    document.getElementById('model').addEventListener("mouseout", handleMouseOut, false);
    function handleMouseOut(e){
      isDown=false;
    }
    function getMousePos(aElement, evt) {
    	var rect = aElement.getBoundingClientRect();
    	return {
      		x: evt.clientX - rect.left,
      		y: evt.clientY - rect.top
    	};
	}
    
    
    // Clears all children and subchildren from an object
    THREE.Object3D.prototype.clear = function(){
        var children = this.children;
        for(var i = children.length - 1; i >= 0 ; i--){
            var child = children[i];
            child.clear();
            this.remove(child);
        };
    };
    
	function RenderSkin(smallSkin) {
        var armWidth = 4;
        var ssT = 0; //smallSkinTranslation
        if (smallSkin) {
            armWidth = 3;
            ssT = 1;
        }
        
        if (rendererIsSetup) {
            console.log("Re-Rendering Skin");
            scene.clear();
        }
        
        var off = 0.1; //Overlay Offset
        
		// Head Parts
		var headTop = [
			new THREE.Vector2(0.125, 56/64),
			new THREE.Vector2(16/64, 56/64),
			new THREE.Vector2(16/64, 1),
			new THREE.Vector2(0.125, 1)
		];
		var headBottom = [
			new THREE.Vector2(16/64, 56/64),
			new THREE.Vector2(0.375, 56/64),
			new THREE.Vector2(0.375, 1),
			new THREE.Vector2(16/64, 1)
		];
		var headLeft = [
			new THREE.Vector2(0, 48/64),
			new THREE.Vector2(0.125, 48/64),
			new THREE.Vector2(0.125, 56/64),
			new THREE.Vector2(0, 56/64)
		];
		var headFront = [
			new THREE.Vector2(0.125, 48/64),
			new THREE.Vector2(16/64, 48/64),
			new THREE.Vector2(16/64 ,56/64),
			new THREE.Vector2(0.125 ,56/64)
		];
		var headRight = [
			new THREE.Vector2(16/64, 48/64),
			new THREE.Vector2(0.375, 48/64),
			new THREE.Vector2(0.375, 56/64),
			new THREE.Vector2(16/64, 56/64)
		];
		var headBack = [
			new THREE.Vector2(0.375, 48/64),
			new THREE.Vector2(32/64, 48/64),
			new THREE.Vector2(32/64, 56/64),
			new THREE.Vector2(0.375, 56/64)
		];
		headBox = new THREE.BoxGeometry(8, 8, 8, 0, 0, 0);
		headBox.faceVertexUvs[0] = [];
		headBox.faceVertexUvs[0][0] = [headRight[3], headRight[0], headRight[2]];
		headBox.faceVertexUvs[0][1] = [headRight[0], headRight[1], headRight[2]];
		headBox.faceVertexUvs[0][2] = [headLeft[3], headLeft[0], headLeft[2]];
		headBox.faceVertexUvs[0][3] = [headLeft[0], headLeft[1], headLeft[2]];
		headBox.faceVertexUvs[0][4] = [headTop[3], headTop[0], headTop[2]];
		headBox.faceVertexUvs[0][5] = [headTop[0], headTop[1], headTop[2]];
		headBox.faceVertexUvs[0][6] = [headBottom[0], headBottom[3], headBottom[1]];
		headBox.faceVertexUvs[0][7] = [headBottom[3], headBottom[2], headBottom[1]];
		headBox.faceVertexUvs[0][8] = [headFront[3], headFront[0], headFront[2]];
		headBox.faceVertexUvs[0][9] = [headFront[0], headFront[1], headFront[2]];
		headBox.faceVertexUvs[0][10] = [headBack[3], headBack[0], headBack[2]];
		headBox.faceVertexUvs[0][11] = [headBack[0], headBack[1], headBack[2]];
		headMesh = new THREE.Mesh(headBox, material);
		headMesh.name = "head";
 		scene.add(headMesh);
		
		// Body Parts
		var bodyTop = [
			new THREE.Vector2(0.3125, 44/64),
			new THREE.Vector2(0.4375, 44/64),
			new THREE.Vector2(0.4375, 48/64),
			new THREE.Vector2(0.3125, 48/64)
		];
		var bodyBottom = [
			new THREE.Vector2(0.4375, 44/64),
			new THREE.Vector2(36/64, 44/64),
			new THREE.Vector2(36/64, 48/64),
			new THREE.Vector2(0.4375, 48/64)
		];
		var bodyLeft = [
			new THREE.Vector2(16/64, 32/64),
			new THREE.Vector2(0.3125, 32/64),
			new THREE.Vector2(0.3125, 44/64),
			new THREE.Vector2(16/64, 44/64)
		];
		var bodyFront = [
			new THREE.Vector2(0.3125, 32/64),
			new THREE.Vector2(0.4375, 32/64),
			new THREE.Vector2(0.4375, 44/64),
			new THREE.Vector2(0.3125, 44/64)
		];
		var bodyRight = [
			new THREE.Vector2(0.4375, 32/64),
			new THREE.Vector2(32/64, 32/64),
			new THREE.Vector2(32/64, 44/64),
			new THREE.Vector2(0.4375, 44/64)
		];
		var bodyBack = [
			new THREE.Vector2(32/64, 32/64),
			new THREE.Vector2(40/64, 32/64),
			new THREE.Vector2(40/64, 44/64),
			new THREE.Vector2(32/64, 44/64)
		];
		bodyBox = new THREE.BoxGeometry(8, 12, 4, 0, 0, 0);
		bodyBox.faceVertexUvs[0] = [];
		bodyBox.faceVertexUvs[0][0] = [bodyRight[3], bodyRight[0], bodyRight[2]];
		bodyBox.faceVertexUvs[0][1] = [bodyRight[0], bodyRight[1], bodyRight[2]];
		bodyBox.faceVertexUvs[0][2] = [bodyLeft[3], bodyLeft[0], bodyLeft[2]];
		bodyBox.faceVertexUvs[0][3] = [bodyLeft[0], bodyLeft[1], bodyLeft[2]];
		bodyBox.faceVertexUvs[0][4] = [bodyTop[3], bodyTop[0], bodyTop[2]];
		bodyBox.faceVertexUvs[0][5] = [bodyTop[0], bodyTop[1], bodyTop[2]];
		bodyBox.faceVertexUvs[0][6] = [bodyBottom[0], bodyBottom[3], bodyBottom[1]];
		bodyBox.faceVertexUvs[0][7] = [bodyBottom[3], bodyBottom[2], bodyBottom[1]];
		bodyBox.faceVertexUvs[0][8] = [bodyFront[3], bodyFront[0], bodyFront[2]];
		bodyBox.faceVertexUvs[0][9] = [bodyFront[0], bodyFront[1], bodyFront[2]];
		bodyBox.faceVertexUvs[0][10] = [bodyBack[3], bodyBack[0], bodyBack[2]];
		bodyBox.faceVertexUvs[0][11] = [bodyBack[0], bodyBack[1], bodyBack[2]];
		bodyMesh = new THREE.Mesh(bodyBox, material);
		bodyMesh.name = "body";
		bodyMesh.position.y = -10;
 		scene.add(bodyMesh);
		
		// Right Arm Parts
		var rightArmTop = [
			new THREE.Vector2(44/64, 44/64),
			new THREE.Vector2((48-ssT)/64, 44/64),
			new THREE.Vector2((48-ssT)/64, 48/64),
			new THREE.Vector2(44/64, 48/64),
		];
		var rightArmBottom = [
			new THREE.Vector2((48-ssT)/64, 44/64),
			new THREE.Vector2((52-ssT*2)/64, 44/64),
			new THREE.Vector2((52-ssT*2)/64, 48/64),
			new THREE.Vector2((48-ssT)/64, 48/64)
		];
		var rightArmLeft = [
			new THREE.Vector2(40/64, 32/64),
			new THREE.Vector2(44/64, 32/64),
			new THREE.Vector2(44/64, 44/64),
			new THREE.Vector2(40/64, 44/64)
		];
		var rightArmFront = [
			new THREE.Vector2(44/64, 32/64),
			new THREE.Vector2((48-ssT)/64, 32/64),
			new THREE.Vector2((48-ssT)/64, 44/64),
			new THREE.Vector2(44/64, 44/64)
		];
		var rightArmRight = [
			new THREE.Vector2((48-ssT)/64, 32/64),
			new THREE.Vector2((52-ssT)/64, 32/64),
			new THREE.Vector2((52-ssT)/64, 44/64),
			new THREE.Vector2((48-ssT)/64, 44/64)
		];
		var rightArmBack = [
			new THREE.Vector2((52-ssT)/64, 32/64),
			new THREE.Vector2((56-ssT*2)/64, 32/64),
			new THREE.Vector2((56-ssT*2)/64, 44/64),
			new THREE.Vector2((52-ssT)/64, 44/64)
		];
		rightArmBox = new THREE.BoxGeometry(armWidth, 12, 4, 0, 0, 0);
		rightArmBox.faceVertexUvs[0] = [];
		rightArmBox.faceVertexUvs[0][0] = [rightArmRight[3], rightArmRight[0], rightArmRight[2]];
		rightArmBox.faceVertexUvs[0][1] = [rightArmRight[0], rightArmRight[1], rightArmRight[2]];
		rightArmBox.faceVertexUvs[0][2] = [rightArmLeft[3], rightArmLeft[0], rightArmLeft[2]];
		rightArmBox.faceVertexUvs[0][3] = [rightArmLeft[0], rightArmLeft[1], rightArmLeft[2]];
		rightArmBox.faceVertexUvs[0][4] = [rightArmTop[3], rightArmTop[0], rightArmTop[2]];
		rightArmBox.faceVertexUvs[0][5] = [rightArmTop[0], rightArmTop[1], rightArmTop[2]];
		rightArmBox.faceVertexUvs[0][6] = [rightArmBottom[0], rightArmBottom[3], rightArmBottom[1]];
		rightArmBox.faceVertexUvs[0][7] = [rightArmBottom[3], rightArmBottom[2], rightArmBottom[1]];
		rightArmBox.faceVertexUvs[0][8] = [rightArmFront[3], rightArmFront[0], rightArmFront[2]];
		rightArmBox.faceVertexUvs[0][9] = [rightArmFront[0], rightArmFront[1], rightArmFront[2]];
		rightArmBox.faceVertexUvs[0][10] = [rightArmBack[3], rightArmBack[0], rightArmBack[2]];
		rightArmBox.faceVertexUvs[0][11] = [rightArmBack[0], rightArmBack[1], rightArmBack[2]];
		rightArmMesh = new THREE.Mesh(rightArmBox, material);
		rightArmMesh.name = "rightArm";
		rightArmMesh.position.y = -10;
		rightArmMesh.position.x = -6;
 		scene.add(rightArmMesh);
		
		// Left Arm Parts
		var leftArmTop = [
			new THREE.Vector2(36/64, 12/64),
			new THREE.Vector2((40-ssT)/64, 12/64),
			new THREE.Vector2((40-ssT)/64, 16/64),
			new THREE.Vector2(36/64, 16/64),
		];
		var leftArmBottom = [
			new THREE.Vector2((40-ssT)/64, 12/64),
			new THREE.Vector2((44-ssT*2)/64, 12/64),
			new THREE.Vector2((44-ssT*2)/64, 16/64),
			new THREE.Vector2((40-ssT)/64, 16/64)
		];
		var leftArmLeft = [
			new THREE.Vector2(32/64, 0),
			new THREE.Vector2(36/64, 0),
			new THREE.Vector2(36/64, 12/64),
			new THREE.Vector2(32/64, 12/64)
		];
		var leftArmFront = [
			new THREE.Vector2(36/64, 0),
			new THREE.Vector2((40-ssT)/64, 0),
			new THREE.Vector2((40-ssT)/64, 12/64),
			new THREE.Vector2(36/64, 12/64)
		];
		var leftArmRight = [
			new THREE.Vector2((40-ssT)/64, 0),
			new THREE.Vector2((44-ssT)/64, 0),
			new THREE.Vector2((44-ssT)/64, 12/64),
			new THREE.Vector2((40-ssT)/64, 12/64)
		];
		var leftArmBack = [
			new THREE.Vector2((44-ssT)/64, 0),
			new THREE.Vector2((48-ssT*2)/64, 0),
			new THREE.Vector2((48-ssT*2)/64, 12/64),
			new THREE.Vector2((44-ssT)/64, 12/64)
		];
		leftArmBox = new THREE.BoxGeometry(armWidth, 12, 4, 0, 0, 0);
		leftArmBox.faceVertexUvs[0] = [];
		leftArmBox.faceVertexUvs[0][0] = [leftArmRight[3], leftArmRight[0], leftArmRight[2]];
		leftArmBox.faceVertexUvs[0][1] = [leftArmRight[0], leftArmRight[1], leftArmRight[2]];
		leftArmBox.faceVertexUvs[0][2] = [leftArmLeft[3], leftArmLeft[0], leftArmLeft[2]];
		leftArmBox.faceVertexUvs[0][3] = [leftArmLeft[0], leftArmLeft[1], leftArmLeft[2]];
		leftArmBox.faceVertexUvs[0][4] = [leftArmTop[3], leftArmTop[0], leftArmTop[2]];
		leftArmBox.faceVertexUvs[0][5] = [leftArmTop[0], leftArmTop[1], leftArmTop[2]];
		leftArmBox.faceVertexUvs[0][6] = [leftArmBottom[0], leftArmBottom[3], leftArmBottom[1]];
		leftArmBox.faceVertexUvs[0][7] = [leftArmBottom[3], leftArmBottom[2], leftArmBottom[1]];
		leftArmBox.faceVertexUvs[0][8] = [leftArmFront[3], leftArmFront[0], leftArmFront[2]];
		leftArmBox.faceVertexUvs[0][9] = [leftArmFront[0], leftArmFront[1], leftArmFront[2]];
		leftArmBox.faceVertexUvs[0][10] = [leftArmBack[3], leftArmBack[0], leftArmBack[2]];
		leftArmBox.faceVertexUvs[0][11] = [leftArmBack[0], leftArmBack[1], leftArmBack[2]];
		leftArmMesh = new THREE.Mesh(leftArmBox, material);
		leftArmMesh.name = "leftArm";
		leftArmMesh.position.y = -10;
		leftArmMesh.position.x = 6;
 		scene.add(leftArmMesh);
		
		// Right Leg Parts
		var rightLegTop = [
			new THREE.Vector2(0.0625, 44/64),
			new THREE.Vector2(0.125, 44/64),
			new THREE.Vector2(0.125, 48/64),
			new THREE.Vector2(0.0625, 48/64),
		];
		var rightLegBottom = [
			new THREE.Vector2(0.125, 44/64),
			new THREE.Vector2(12/64, 44/64),
			new THREE.Vector2(12/64, 48/64),
			new THREE.Vector2(0.125, 48/64)
		];
		var rightLegLeft = [
			new THREE.Vector2(0, 32/64),
			new THREE.Vector2(0.0625, 32/64),
			new THREE.Vector2(0.0625, 44/64),
			new THREE.Vector2(0, 44/64)
		];
		var rightLegFront = [
			new THREE.Vector2(0.0625, 32/64),
			new THREE.Vector2(0.125, 32/64),
			new THREE.Vector2(0.125, 44/64),
			new THREE.Vector2(0.0625, 44/64)
		];
		var rightLegRight = [
			new THREE.Vector2(0.125, 32/64),
			new THREE.Vector2(12/64, 32/64),
			new THREE.Vector2(12/64, 44/64),
			new THREE.Vector2(0.125, 44/64)
		];
		var rightLegBack = [
			new THREE.Vector2(12/64, 32/64),
			new THREE.Vector2(16/64, 32/64),
			new THREE.Vector2(16/64, 44/64),
			new THREE.Vector2(12/64, 44/64)
		];
		rightLegBox = new THREE.BoxGeometry(4, 12, 4, 0, 0, 0);
		rightLegBox.faceVertexUvs[0] = [];
		rightLegBox.faceVertexUvs[0][0] = [rightLegRight[3], rightLegRight[0], rightLegRight[2]];
		rightLegBox.faceVertexUvs[0][1] = [rightLegRight[0], rightLegRight[1], rightLegRight[2]];
		rightLegBox.faceVertexUvs[0][2] = [rightLegLeft[3], rightLegLeft[0], rightLegLeft[2]];
		rightLegBox.faceVertexUvs[0][3] = [rightLegLeft[0], rightLegLeft[1], rightLegLeft[2]];
		rightLegBox.faceVertexUvs[0][4] = [rightLegTop[3], rightLegTop[0], rightLegTop[2]];
		rightLegBox.faceVertexUvs[0][5] = [rightLegTop[0], rightLegTop[1], rightLegTop[2]];
		rightLegBox.faceVertexUvs[0][6] = [rightLegBottom[0], rightLegBottom[3], rightLegBottom[1]];
		rightLegBox.faceVertexUvs[0][7] = [rightLegBottom[3], rightLegBottom[2], rightLegBottom[1]];
		rightLegBox.faceVertexUvs[0][8] = [rightLegFront[3], rightLegFront[0], rightLegFront[2]];
		rightLegBox.faceVertexUvs[0][9] = [rightLegFront[0], rightLegFront[1], rightLegFront[2]];
		rightLegBox.faceVertexUvs[0][10] = [rightLegBack[3], rightLegBack[0], rightLegBack[2]];
		rightLegBox.faceVertexUvs[0][11] = [rightLegBack[0], rightLegBack[1], rightLegBack[2]];
		rightLegMesh = new THREE.Mesh(rightLegBox, material);
		rightLegMesh.name = "rightLeg"
		rightLegMesh.position.y = -22;
		rightLegMesh.position.x = -2;
 		scene.add(rightLegMesh);
		
		// Left Leg Parts
		var leftLegTop = [
			new THREE.Vector2(0.3125, 12/64),
			new THREE.Vector2(0.375, 12/64),
			new THREE.Vector2(0.375, 16/64),
			new THREE.Vector2(0.3125, 16/64),
		];
		var leftLegBottom = [
			new THREE.Vector2(0.375, 12/64),
			new THREE.Vector2(0.4375, 12/64),
			new THREE.Vector2(0.4375, 16/64),
			new THREE.Vector2(0.375, 16/64)
		];
		var leftLegLeft = [
			new THREE.Vector2(16/64, 0),
			new THREE.Vector2(0.3125, 0),
			new THREE.Vector2(0.3125, 12/64),
			new THREE.Vector2(16/64, 12/64)
		];
		var leftLegFront = [
			new THREE.Vector2(0.3125, 0),
			new THREE.Vector2(0.375, 0),
			new THREE.Vector2(0.375, 12/64),
			new THREE.Vector2(0.3125, 12/64)
		];
		var leftLegRight = [
			new THREE.Vector2(0.375, 0),
			new THREE.Vector2(0.4375, 0),
			new THREE.Vector2(0.4375, 12/64),
			new THREE.Vector2(0.375, 12/64)
		];
		var leftLegBack = [
			new THREE.Vector2(0.4375, 0),
			new THREE.Vector2(32/64, 0),
			new THREE.Vector2(32/64, 12/64),
			new THREE.Vector2(0.4375, 12/64)
		];
		leftLegBox = new THREE.BoxGeometry(4, 12, 4, 0, 0, 0);
		leftLegBox.faceVertexUvs[0] = [];
		leftLegBox.faceVertexUvs[0][0] = [leftLegRight[3], leftLegRight[0], leftLegRight[2]];
		leftLegBox.faceVertexUvs[0][1] = [leftLegRight[0], leftLegRight[1], leftLegRight[2]];
		leftLegBox.faceVertexUvs[0][2] = [leftLegLeft[3], leftLegLeft[0], leftLegLeft[2]];
		leftLegBox.faceVertexUvs[0][3] = [leftLegLeft[0], leftLegLeft[1], leftLegLeft[2]];
		leftLegBox.faceVertexUvs[0][4] = [leftLegTop[3], leftLegTop[0], leftLegTop[2]];
		leftLegBox.faceVertexUvs[0][5] = [leftLegTop[0], leftLegTop[1], leftLegTop[2]];
		leftLegBox.faceVertexUvs[0][6] = [leftLegBottom[0], leftLegBottom[3], leftLegBottom[1]];
		leftLegBox.faceVertexUvs[0][7] = [leftLegBottom[3], leftLegBottom[2], leftLegBottom[1]];
		leftLegBox.faceVertexUvs[0][8] = [leftLegFront[3], leftLegFront[0], leftLegFront[2]];
		leftLegBox.faceVertexUvs[0][9] = [leftLegFront[0], leftLegFront[1], leftLegFront[2]];
		leftLegBox.faceVertexUvs[0][10] = [leftLegBack[3], leftLegBack[0], leftLegBack[2]];
		leftLegBox.faceVertexUvs[0][11] = [leftLegBack[0], leftLegBack[1], leftLegBack[2]];
		leftLegMesh = new THREE.Mesh(leftLegBox, material);
		leftLegMesh.name = "leftLeg";
		leftLegMesh.position.y = -22;
		leftLegMesh.position.x = 2;
 		scene.add(leftLegMesh);
		
		// Head Overlay Parts
		var head2Top = [
			new THREE.Vector2(40/64, 56/64),
			new THREE.Vector2(48/64, 56/64),
			new THREE.Vector2(48/64, 1),
			new THREE.Vector2(40/64, 1)
		];
		var head2Bottom = [
			new THREE.Vector2(48/64, 56/64),
			new THREE.Vector2(56/64, 56/64),
			new THREE.Vector2(56/64, 1),
			new THREE.Vector2(48/64, 1)
		];
		var head2Left = [
			new THREE.Vector2(32/64, 48/64),
			new THREE.Vector2(40/64, 48/64),
			new THREE.Vector2(40/64, 56/64),
			new THREE.Vector2(32/64, 56/64)
		];
		var head2Front = [
			new THREE.Vector2(40/64, 48/64),
			new THREE.Vector2(48/64, 48/64),
			new THREE.Vector2(48/64, 56/64),
			new THREE.Vector2(40/64, 56/64)
		];
		var head2Right = [
			new THREE.Vector2(48/64, 48/64),
			new THREE.Vector2(56/64, 48/64),
			new THREE.Vector2(56/64, 56/64),
			new THREE.Vector2(48/64, 56/64)
		];
		var head2Back = [
			new THREE.Vector2(56/64, 48/64),
			new THREE.Vector2(1, 48/64),
			new THREE.Vector2(1, 56/64),
			new THREE.Vector2(56/64, 56/64)
		];
		head2Box = new THREE.BoxGeometry(9, 9, 9, 0, 0, 0);
		head2Box.faceVertexUvs[0] = [];
		head2Box.faceVertexUvs[0][0] = [head2Right[3], head2Right[0], head2Right[2]];
		head2Box.faceVertexUvs[0][1] = [head2Right[0], head2Right[1], head2Right[2]];
		head2Box.faceVertexUvs[0][2] = [head2Left[3], head2Left[0], head2Left[2]];
		head2Box.faceVertexUvs[0][3] = [head2Left[0], head2Left[1], head2Left[2]];
		head2Box.faceVertexUvs[0][4] = [head2Top[3], head2Top[0], head2Top[2]];
		head2Box.faceVertexUvs[0][5] = [head2Top[0], head2Top[1], head2Top[2]];
		head2Box.faceVertexUvs[0][6] = [head2Bottom[0], head2Bottom[3], head2Bottom[1]];
		head2Box.faceVertexUvs[0][7] = [head2Bottom[3], head2Bottom[2], head2Bottom[1]];
		head2Box.faceVertexUvs[0][8] = [head2Front[3], head2Front[0], head2Front[2]];
		head2Box.faceVertexUvs[0][9] = [head2Front[0], head2Front[1], head2Front[2]];
		head2Box.faceVertexUvs[0][10] = [head2Back[3], head2Back[0], head2Back[2]];
		head2Box.faceVertexUvs[0][11] = [head2Back[0], head2Back[1], head2Back[2]];
		head2Mesh = new THREE.Mesh(head2Box, material2);
		head2Mesh.name = "head2"
 		scene.add(head2Mesh);
		
		// Body Overlay Parts
		var body2Top = [
			new THREE.Vector2(0.3125, 0.4375),
			new THREE.Vector2(0.4375, 0.4375),
			new THREE.Vector2(0.4375, 32/64),
			new THREE.Vector2(0.3125, 32/64)
		];
		var body2Bottom = [
			new THREE.Vector2(0.4375, 0.4375),
			new THREE.Vector2(36/64, 0.4375),
			new THREE.Vector2(36/64, 32/64),
			new THREE.Vector2(0.4375, 32/64)
		];
		var body2Left = [
			new THREE.Vector2(16/64, 16/64),
			new THREE.Vector2(0.3125, 16/64),
			new THREE.Vector2(0.3125, 0.4375),
			new THREE.Vector2(16/64, 0.4375)
		];
		var body2Front = [
			new THREE.Vector2(0.3125, 16/64),
			new THREE.Vector2(0.4375, 16/64),
			new THREE.Vector2(0.4375, 0.4375),
			new THREE.Vector2(0.3125, 0.4375)
		];
		var body2Right = [
			new THREE.Vector2(0.4375, 16/64),
			new THREE.Vector2(32/64, 16/64),
			new THREE.Vector2(32/64, 0.4375),
			new THREE.Vector2(0.4375, 0.4375)
		];
		var body2Back = [
			new THREE.Vector2(32/64, 16/64),
			new THREE.Vector2(40/64, 16/64),
			new THREE.Vector2(40/64, 0.4375),
			new THREE.Vector2(32/64, 0.4375)
		];
		body2Box = new THREE.BoxGeometry(8.5, 13, 4.5, 0, 0, 0);
		body2Box.faceVertexUvs[0] = [];
		body2Box.faceVertexUvs[0][0] = [body2Right[3], body2Right[0], body2Right[2]];
		body2Box.faceVertexUvs[0][1] = [body2Right[0], body2Right[1], body2Right[2]];
		body2Box.faceVertexUvs[0][2] = [body2Left[3], body2Left[0], body2Left[2]];
		body2Box.faceVertexUvs[0][3] = [body2Left[0], body2Left[1], body2Left[2]];
		body2Box.faceVertexUvs[0][4] = [body2Top[3], body2Top[0], body2Top[2]];
		body2Box.faceVertexUvs[0][5] = [body2Top[0], body2Top[1], body2Top[2]];
		body2Box.faceVertexUvs[0][6] = [body2Bottom[0], body2Bottom[3], body2Bottom[1]];
		body2Box.faceVertexUvs[0][7] = [body2Bottom[3], body2Bottom[2], body2Bottom[1]];
		body2Box.faceVertexUvs[0][8] = [body2Front[3], body2Front[0], body2Front[2]];
		body2Box.faceVertexUvs[0][9] = [body2Front[0], body2Front[1], body2Front[2]];
		body2Box.faceVertexUvs[0][10] = [body2Back[3], body2Back[0], body2Back[2]];
		body2Box.faceVertexUvs[0][11] = [body2Back[0], body2Back[1], body2Back[2]];
		body2Mesh = new THREE.Mesh(body2Box, material2);
		body2Mesh.name = "body2";
		body2Mesh.position.y = -10;
 		scene.add(body2Mesh);
		
		// Right Arm Overlay Parts
		var rightArm2Top = [
			new THREE.Vector2(44/64, 0.4375),
			new THREE.Vector2((48-ssT)/64, 0.4375),
			new THREE.Vector2((48-ssT)/64, 32/64),
			new THREE.Vector2(44/64, 32/64),
		];
		var rightArm2Bottom = [
			new THREE.Vector2((48-ssT)/64, 0.4375),
			new THREE.Vector2((52-ssT*2)/64, 0.4375),
			new THREE.Vector2((52-ssT*2)/64, 32/64),
			new THREE.Vector2((48-ssT)/64, 32/64)
		];
		var rightArm2Left = [
			new THREE.Vector2(40/64, 16/64),
			new THREE.Vector2(44/64, 16/64),
			new THREE.Vector2(44/64, 0.4375),
			new THREE.Vector2(40/64, 0.4375)
		];
		var rightArm2Front = [
			new THREE.Vector2(44/64, 16/64),
			new THREE.Vector2((48-ssT)/64, 16/64),
			new THREE.Vector2((48-ssT)/64, 0.4375),
			new THREE.Vector2(44/64, 0.4375)
		];
		var rightArm2Right = [
			new THREE.Vector2((48-ssT)/64, 16/64),
			new THREE.Vector2((52-ssT)/64, 16/64),
			new THREE.Vector2((52-ssT)/64, 0.4375),
			new THREE.Vector2((48-ssT)/64, 0.4375)
		];
		var rightArm2Back = [
			new THREE.Vector2((52-ssT)/64, 16/64),
			new THREE.Vector2((56-ssT*2)/64, 16/64),
			new THREE.Vector2((56-ssT*2)/64, 0.4375),
			new THREE.Vector2((52-ssT)/64, 0.4375)
		];
		rightArm2Box = new THREE.BoxGeometry(armWidth + off, 12 + off, 4 + off, 0, 0, 0);
		rightArm2Box.faceVertexUvs[0] = [];
		rightArm2Box.faceVertexUvs[0][0] = [rightArm2Right[3], rightArm2Right[0], rightArm2Right[2]];
		rightArm2Box.faceVertexUvs[0][1] = [rightArm2Right[0], rightArm2Right[1], rightArm2Right[2]];
		rightArm2Box.faceVertexUvs[0][2] = [rightArm2Left[3], rightArm2Left[0], rightArm2Left[2]];
		rightArm2Box.faceVertexUvs[0][3] = [rightArm2Left[0], rightArm2Left[1], rightArm2Left[2]];
		rightArm2Box.faceVertexUvs[0][4] = [rightArm2Top[3], rightArm2Top[0], rightArm2Top[2]];
		rightArm2Box.faceVertexUvs[0][5] = [rightArm2Top[0], rightArm2Top[1], rightArm2Top[2]];
		rightArm2Box.faceVertexUvs[0][6] = [rightArm2Bottom[0], rightArm2Bottom[3], rightArm2Bottom[1]];
		rightArm2Box.faceVertexUvs[0][7] = [rightArm2Bottom[3], rightArm2Bottom[2], rightArm2Bottom[1]];
		rightArm2Box.faceVertexUvs[0][8] = [rightArm2Front[3], rightArm2Front[0], rightArm2Front[2]];
		rightArm2Box.faceVertexUvs[0][9] = [rightArm2Front[0], rightArm2Front[1], rightArm2Front[2]];
		rightArm2Box.faceVertexUvs[0][10] = [rightArm2Back[3], rightArm2Back[0], rightArm2Back[2]];
		rightArm2Box.faceVertexUvs[0][11] = [rightArm2Back[0], rightArm2Back[1], rightArm2Back[2]];
		rightArm2Mesh = new THREE.Mesh(rightArm2Box, material2);
		rightArm2Mesh.name = "rightArm2";
		rightArm2Mesh.position.y = -10;
		rightArm2Mesh.position.x = -6;
 		scene.add(rightArm2Mesh);
		
		// Left Arm Overlay Parts
		var leftArm2Top = [
			new THREE.Vector2(52/64, 12/64),
			new THREE.Vector2((56-ssT)/64, 12/64),
			new THREE.Vector2((56-ssT)/64, 16/64),
			new THREE.Vector2(52/64, 16/64),
		];
		var leftArm2Bottom = [
			new THREE.Vector2((56-ssT)/64, 12/64),
			new THREE.Vector2((60-ssT*2)/64, 12/64),
			new THREE.Vector2((60-ssT*2)/64, 16/64),
			new THREE.Vector2((56-ssT)/64, 16/64)
		];
		var leftArm2Left = [
			new THREE.Vector2(48/64, 0),
			new THREE.Vector2(52/64, 0),
			new THREE.Vector2(52/64, 12/64),
			new THREE.Vector2(48/64, 12/64)
		];
		var leftArm2Front = [
			new THREE.Vector2(52/64, 0),
			new THREE.Vector2((56-ssT)/64, 0),
			new THREE.Vector2((56-ssT)/64, 12/64),
			new THREE.Vector2(52/64, 12/64)
		];
		var leftArm2Right = [
			new THREE.Vector2((56-ssT)/64, 0),
			new THREE.Vector2((60-ssT)/64, 0),
			new THREE.Vector2((60-ssT)/64, 12/64),
			new THREE.Vector2((56-ssT)/64, 12/64)
		];
		var leftArm2Back = [
			new THREE.Vector2((60-ssT)/64, 0),
			new THREE.Vector2((64-ssT*2)/64, 0),
			new THREE.Vector2((64-ssT*2)/64, 12/64),
			new THREE.Vector2((60-ssT)/64, 12/64)
		];
		leftArm2Box = new THREE.BoxGeometry(armWidth + off, 12 + off, 4 + off, 0, 0, 0);
		leftArm2Box.faceVertexUvs[0] = [];
		leftArm2Box.faceVertexUvs[0][0] = [leftArm2Right[3], leftArm2Right[0], leftArm2Right[2]];
		leftArm2Box.faceVertexUvs[0][1] = [leftArm2Right[0], leftArm2Right[1], leftArm2Right[2]];
		leftArm2Box.faceVertexUvs[0][2] = [leftArm2Left[3], leftArm2Left[0], leftArm2Left[2]];
		leftArm2Box.faceVertexUvs[0][3] = [leftArm2Left[0], leftArm2Left[1], leftArm2Left[2]];
		leftArm2Box.faceVertexUvs[0][4] = [leftArm2Top[3], leftArm2Top[0], leftArm2Top[2]];
		leftArm2Box.faceVertexUvs[0][5] = [leftArm2Top[0], leftArm2Top[1], leftArm2Top[2]];
		leftArm2Box.faceVertexUvs[0][6] = [leftArm2Bottom[0], leftArm2Bottom[3], leftArm2Bottom[1]];
		leftArm2Box.faceVertexUvs[0][7] = [leftArm2Bottom[3], leftArm2Bottom[2], leftArm2Bottom[1]];
		leftArm2Box.faceVertexUvs[0][8] = [leftArm2Front[3], leftArm2Front[0], leftArm2Front[2]];
		leftArm2Box.faceVertexUvs[0][9] = [leftArm2Front[0], leftArm2Front[1], leftArm2Front[2]];
		leftArm2Box.faceVertexUvs[0][10] = [leftArm2Back[3], leftArm2Back[0], leftArm2Back[2]];
		leftArm2Box.faceVertexUvs[0][11] = [leftArm2Back[0], leftArm2Back[1], leftArm2Back[2]];
		leftArm2Mesh = new THREE.Mesh(leftArm2Box, material2);
		leftArm2Mesh.name = "leftArm2";
		leftArm2Mesh.position.y = -10;
		leftArm2Mesh.position.x = 6;
 		scene.add(leftArm2Mesh);
		
		// Right Leg Overlay Parts
		var rightLeg2Top = [
			new THREE.Vector2(0.0625, 0.4375),
			new THREE.Vector2(0.125, 0.4375),
			new THREE.Vector2(0.125, 32/64),
			new THREE.Vector2(0.0625, 32/64),
		];
		var rightLeg2Bottom = [
			new THREE.Vector2(0.125, 0.4375),
			new THREE.Vector2(12/64, 0.4375),
			new THREE.Vector2(12/64, 32/64),
			new THREE.Vector2(0.125, 32/64)
		];
		var rightLeg2Left = [
			new THREE.Vector2(0, 16/64),
			new THREE.Vector2(0.0625, 16/64),
			new THREE.Vector2(0.0625, 0.4375),
			new THREE.Vector2(0, 0.4375)
		];
		var rightLeg2Front = [
			new THREE.Vector2(0.0625, 16/64),
			new THREE.Vector2(0.125, 16/64),
			new THREE.Vector2(0.125, 0.4375),
			new THREE.Vector2(0.0625, 0.4375)
		];
		var rightLeg2Right = [
			new THREE.Vector2(0.125, 16/64),
			new THREE.Vector2(12/64, 16/64),
			new THREE.Vector2(12/64, 0.4375),
			new THREE.Vector2(0.125, 0.4375)
		];
		var rightLeg2Back = [
			new THREE.Vector2(12/64, 16/64),
			new THREE.Vector2(16/64, 16/64),
			new THREE.Vector2(16/64, 0.4375),
			new THREE.Vector2(12/64, 0.4375)
		];
		rightLeg2Box = new THREE.BoxGeometry(4 + off, 12 + off, 4 + off, 0, 0, 0);
		rightLeg2Box.faceVertexUvs[0] = [];
		rightLeg2Box.faceVertexUvs[0][0] = [rightLeg2Right[3], rightLeg2Right[0], rightLeg2Right[2]];
		rightLeg2Box.faceVertexUvs[0][1] = [rightLeg2Right[0], rightLeg2Right[1], rightLeg2Right[2]];
		rightLeg2Box.faceVertexUvs[0][2] = [rightLeg2Left[3], rightLeg2Left[0], rightLeg2Left[2]];
		rightLeg2Box.faceVertexUvs[0][3] = [rightLeg2Left[0], rightLeg2Left[1], rightLeg2Left[2]];
		rightLeg2Box.faceVertexUvs[0][4] = [rightLeg2Top[3], rightLeg2Top[0], rightLeg2Top[2]];
		rightLeg2Box.faceVertexUvs[0][5] = [rightLeg2Top[0], rightLeg2Top[1], rightLeg2Top[2]];
		rightLeg2Box.faceVertexUvs[0][6] = [rightLeg2Bottom[0], rightLeg2Bottom[3], rightLeg2Bottom[1]];
		rightLeg2Box.faceVertexUvs[0][7] = [rightLeg2Bottom[3], rightLeg2Bottom[2], rightLeg2Bottom[1]];
		rightLeg2Box.faceVertexUvs[0][8] = [rightLeg2Front[3], rightLeg2Front[0], rightLeg2Front[2]];
		rightLeg2Box.faceVertexUvs[0][9] = [rightLeg2Front[0], rightLeg2Front[1], rightLeg2Front[2]];
		rightLeg2Box.faceVertexUvs[0][10] = [rightLeg2Back[3], rightLeg2Back[0], rightLeg2Back[2]];
		rightLeg2Box.faceVertexUvs[0][11] = [rightLeg2Back[0], rightLeg2Back[1], rightLeg2Back[2]];
		rightLeg2Mesh = new THREE.Mesh(rightLeg2Box, material2);
		rightLeg2Mesh.name = "rightLeg2"
		rightLeg2Mesh.position.y = -22;
		rightLeg2Mesh.position.x = -2;
 		scene.add(rightLeg2Mesh);
		
		// Left Leg Overlay Parts
		var leftLeg2Top = [
			new THREE.Vector2(0.0625, 12/64),
			new THREE.Vector2(0.125, 12/64),
			new THREE.Vector2(0.125, 16/64),
			new THREE.Vector2(0.0625, 16/64),
		];
		var leftLeg2Bottom = [
			new THREE.Vector2(0.125, 12/64),
			new THREE.Vector2(12/64, 12/64),
			new THREE.Vector2(12/64, 16/64),
			new THREE.Vector2(0.125, 16/64)
		];
		var leftLeg2Left = [
			new THREE.Vector2(0, 0),
			new THREE.Vector2(0.0625, 0),
			new THREE.Vector2(0.0625, 12/64),
			new THREE.Vector2(0, 12/64)
		];
		var leftLeg2Front = [
			new THREE.Vector2(0.0625, 0),
			new THREE.Vector2(0.125, 0),
			new THREE.Vector2(0.125, 12/64),
			new THREE.Vector2(0.0625, 12/64)
		];
		var leftLeg2Right = [
			new THREE.Vector2(0.125, 0),
			new THREE.Vector2(12/64, 0),
			new THREE.Vector2(12/64, 12/64),
			new THREE.Vector2(0.125, 12/64)
		];
		var leftLeg2Back = [
			new THREE.Vector2(12/64, 0),
			new THREE.Vector2(16/64, 0),
			new THREE.Vector2(16/64, 12/64),
			new THREE.Vector2(12/64, 12/64)
		];
		var leftLeg2Box = new THREE.BoxGeometry(4 + off, 12 + off, 4 + off, 0, 0, 0);
		leftLeg2Box.faceVertexUvs[0] = [];
		leftLeg2Box.faceVertexUvs[0][0] = [leftLeg2Right[3], leftLeg2Right[0], leftLeg2Right[2]];
		leftLeg2Box.faceVertexUvs[0][1] = [leftLeg2Right[0], leftLeg2Right[1], leftLeg2Right[2]];
		leftLeg2Box.faceVertexUvs[0][2] = [leftLeg2Left[3], leftLeg2Left[0], leftLeg2Left[2]];
		leftLeg2Box.faceVertexUvs[0][3] = [leftLeg2Left[0], leftLeg2Left[1], leftLeg2Left[2]];
		leftLeg2Box.faceVertexUvs[0][4] = [leftLeg2Top[3], leftLeg2Top[0], leftLeg2Top[2]];
		leftLeg2Box.faceVertexUvs[0][5] = [leftLeg2Top[0], leftLeg2Top[1], leftLeg2Top[2]];
		leftLeg2Box.faceVertexUvs[0][6] = [leftLeg2Bottom[0], leftLeg2Bottom[3], leftLeg2Bottom[1]];
		leftLeg2Box.faceVertexUvs[0][7] = [leftLeg2Bottom[3], leftLeg2Bottom[2], leftLeg2Bottom[1]];
		leftLeg2Box.faceVertexUvs[0][8] = [leftLeg2Front[3], leftLeg2Front[0], leftLeg2Front[2]];
		leftLeg2Box.faceVertexUvs[0][9] = [leftLeg2Front[0], leftLeg2Front[1], leftLeg2Front[2]];
		leftLeg2Box.faceVertexUvs[0][10] = [leftLeg2Back[3], leftLeg2Back[0], leftLeg2Back[2]];
		leftLeg2Box.faceVertexUvs[0][11] = [leftLeg2Back[0], leftLeg2Back[1], leftLeg2Back[2]];
		leftLeg2Mesh = new THREE.Mesh(leftLeg2Box, material2);
		leftLeg2Mesh.name = "leftLeg2";
		leftLeg2Mesh.position.y = -22;
		leftLeg2Mesh.position.x = 2;
 		scene.add(leftLeg2Mesh);
        
        updateToggles();
		
        if (!rendererIsSetup) {
            // Add to page
            container = document.getElementById('model');

            renderer = new THREE.WebGLRenderer({alpha: true});
            renderer.setSize(window.innerWidth - sidebarWidth, window.innerHeight);

            window.addEventListener('resize', onWindowResize, false);

            model.appendChild(renderer.domElement);
            rendererIsSetup = true;
        }
	}
	
	function onWindowResize() {
	    camera.aspect = (window.innerWidth - sidebarWidth) / window.innerHeight;
	    camera.updateProjectionMatrix();

	    renderer.setSize(window.innerWidth - sidebarWidth, window.innerHeight);
	}
	
	function Animate() {
        requestAnimationFrame(Animate);
        
        //Camera Movement
        camera.position.x =  radius*Math.sin(rotationX) * Math.abs(Math.cos(rotationY));
        camera.position.y =  -radius*Math.sin(rotationY) + camera_translate;
        camera.position.z =  radius*Math.cos(rotationX) * Math.abs(Math.cos(rotationY));
        camera.lookAt(camera_target.position);
        
        //alpha = /*(Math.PI / 2)*/ + (Math.PI / 16);
		alpha += Math.PI / 320;
		
		//Leg Swing
		leftLeg2Mesh.rotation.x = leftLegMesh.rotation.x = Math.cos(alpha*4);
		leftLeg2Mesh.position.z = leftLegMesh.position.z = 0 - 6*Math.sin(leftLegMesh.rotation.x);
		leftLeg2Mesh.position.y = leftLegMesh.position.y = -16 - 6*Math.abs(Math.cos(leftLegMesh.rotation.x));
		rightLeg2Mesh.rotation.x = rightLegMesh.rotation.x = Math.cos(alpha*4 + (Math.PI));
		rightLeg2Mesh.position.z = rightLegMesh.position.z = 0 - 6*Math.sin(rightLegMesh.rotation.x);
		rightLeg2Mesh.position.y = rightLegMesh.position.y = -16 - 6*Math.abs(Math.cos(rightLegMesh.rotation.x));
		
		//Arm Swing
		leftArm2Mesh.rotation.x = leftArmMesh.rotation.x = Math.cos(alpha*4 + (Math.PI));
		leftArm2Mesh.position.z = leftArmMesh.position.z = 0 - 6*Math.sin(leftArmMesh.rotation.x);
		leftArm2Mesh.position.y = leftArmMesh.position.y = -4 - 6*Math.abs(Math.cos(leftArmMesh.rotation.x));
		rightArm2Mesh.rotation.x = rightArmMesh.rotation.x = Math.cos(alpha*4);
		rightArm2Mesh.position.z = rightArmMesh.position.z = 0 - 6*Math.sin(rightArmMesh.rotation.x);
		rightArm2Mesh.position.y = rightArmMesh.position.y = -4 - 6*Math.abs(Math.cos(rightArmMesh.rotation.x));
		
		renderer.render(scene, camera);
	}
    
    function updateToggles() {
        toggleHead();
        toggleLeftArm();
        toggleRightArm();
        toggleBody();
        toggleLeftLeg();
        toggleRightLeg();
        toggleHead2();
        toggleLeftArm2();
        toggleRightArm2();
        toggleBody2();
        toggleLeftLeg2();
        toggleRightLeg2();
    }
	
	// Handle the sidebar input things
	// Make checkboxes toggle visibility
	headToggle = document.getElementById('headToggle');
	headToggle.addEventListener("change", toggleHead, false);
	function toggleHead() {
		console.log("toggling head");
		var head = scene.getObjectByName("head", false);
		head.visible = headToggle.checked;
		console.log(head);
	}
	leftArmToggle = document.getElementById('leftArmToggle');
	leftArmToggle.addEventListener("change", toggleLeftArm, false);
	function toggleLeftArm() {
		var leftArm = scene.getObjectByName("leftArm", false);
		leftArm.visible = leftArmToggle.checked;
	}
	rightArmToggle = document.getElementById('rightArmToggle');
	rightArmToggle.addEventListener("change", toggleRightArm, false);
	function toggleRightArm() {
		var rightArm = scene.getObjectByName("rightArm", false);
		rightArm.visible = rightArmToggle.checked;
	}
	bodyToggle = document.getElementById('bodyToggle');
	bodyToggle.addEventListener("change", toggleBody, false);
	function toggleBody() {
		var body = scene.getObjectByName("body", false);
		body.visible = bodyToggle.checked;
	}
	leftLegToggle = document.getElementById('leftLegToggle');
	leftLegToggle.addEventListener("change", toggleLeftLeg, false);
	function toggleLeftLeg() {
		var leftLeg = scene.getObjectByName("leftLeg", false);
		leftLeg.visible = leftLegToggle.checked;
	}
	rightLegToggle = document.getElementById('rightLegToggle');
	rightLegToggle.addEventListener("change", toggleRightLeg, false);
	function toggleRightLeg() {
		var rightLeg = scene.getObjectByName("rightLeg", false);
		rightLeg.visible = rightLegToggle.checked;
	}
	head2Toggle = document.getElementById('head2Toggle');
	head2Toggle.addEventListener("change", toggleHead2, false);
	function toggleHead2() {
		var head2 = scene.getObjectByName("head2", false);
		head2.visible = head2Toggle.checked;
	}
	leftArm2Toggle = document.getElementById('leftArm2Toggle');
	leftArm2Toggle.addEventListener("change", toggleLeftArm2, false);
	function toggleLeftArm2() {
		var leftArm2 = scene.getObjectByName("leftArm2", false);
		leftArm2.visible = leftArm2Toggle.checked;
	}
	rightArm2Toggle = document.getElementById('rightArm2Toggle');
	rightArm2Toggle.addEventListener("change", toggleRightArm2, false);
	function toggleRightArm2() {
		var rightArm2 = scene.getObjectByName("rightArm2", false);
		rightArm2.visible = rightArm2Toggle.checked;
	}
	body2Toggle = document.getElementById('body2Toggle');
	body2Toggle.addEventListener("change", toggleBody2, false);
	function toggleBody2() {
		var body2 = scene.getObjectByName("body2", false);
		body2.visible = body2Toggle.checked;
	}
	leftLeg2Toggle = document.getElementById('leftLeg2Toggle');
	leftLeg2Toggle.addEventListener("change", toggleLeftLeg2, false);
	function toggleLeftLeg2() {
		var leftLeg2 = scene.getObjectByName("leftLeg2", false);
		leftLeg2.visible = leftLeg2Toggle.checked;
	}
	rightLeg2Toggle = document.getElementById('rightLeg2Toggle');
	rightLeg2Toggle.addEventListener("change", toggleRightLeg2, false);
	function toggleRightLeg2() {
		var rightLeg2 = scene.getObjectByName("rightLeg2", false);
		rightLeg2.visible = rightLeg2Toggle.checked;
	}

	function getJSON(url) {
		return fetch(url).then(function(response) {
			return response.json();
		})
	}
	// Change the username
	document.getElementById('username').onkeypress = async function(e){
		if (!e) e = window.event;
		var keyCode = e.keyCode || e.which;
		if (keyCode == '13'){
			// Enter pressed, set new image
			var uid = await getJSON('https://cors-anywhere.herokuapp.com/https://api.mojang.com/users/profiles/minecraft/' + document.getElementById('username').value).then(function(response){return response.id});
			img.src = 'https://crafatar.com/skins/' + uid;
		}
	}
    
    //Change the username via file input
    document.getElementById('file_input').addEventListener("change", loadFile, false);
	function loadFile(e) {
		var inputFile = e.target.files[0];
		console.log(inputFile);
    	img.src = window.URL.createObjectURL(inputFile);
	}
</script>
</body>
</html>
